Oct-07 17:03:52.773 [main] DEBUG nextflow.cli.Launcher - $> nextflow run main.nf --INDEX /media/vikas/fast/data/metagenomics_index/ --INPUT_FOLDER /private/groups/kimlab/vikas/metagenomics/publication/ncm_2024/input/time_tagged_input/CSF001/ --ALIGN_ALL_FUNGI --KRAKEN_PREFILTER --PREFILTER_THRESHOLD 2 --CHOPPER_MAXLENGTH 500000 --CHOPPER_QUALITY 9 --OUTPUT aPOMP_out_kraken -with-docker 'ubuntu:18.04' -resume -with-report -with-trace -profile server
Oct-07 17:03:52.932 [main] DEBUG nextflow.cli.CmdRun - N E X T F L O W  ~  version 24.04.4
Oct-07 17:03:52.961 [main] DEBUG nextflow.plugin.PluginsFacade - Setting up plugin manager > mode=prod; embedded=false; plugins-dir=/private/home/vpeddu/.nextflow/plugins; core-plugins: nf-amazon@2.5.3,nf-azure@1.6.1,nf-cloudcache@0.4.1,nf-codecommit@0.2.1,nf-console@1.1.3,nf-ga4gh@1.3.0,nf-google@1.13.2-patch1,nf-tower@1.9.1,nf-wave@1.4.2-patch1
Oct-07 17:03:52.977 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Enabled plugins: []
Oct-07 17:03:52.978 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Disabled plugins: []
Oct-07 17:03:52.983 [main] INFO  org.pf4j.DefaultPluginManager - PF4J version 3.12.0 in 'deployment' mode
Oct-07 17:03:53.000 [main] INFO  org.pf4j.AbstractPluginManager - No plugins
Oct-07 17:03:53.030 [main] DEBUG nextflow.config.ConfigBuilder - Found config local: /data/scratch/vpeddu/aPOMP/nextflow.config
Oct-07 17:03:53.034 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /data/scratch/vpeddu/aPOMP/nextflow.config
Oct-07 17:03:53.068 [main] DEBUG n.secret.LocalSecretsProvider - Secrets store: /private/home/vpeddu/.nextflow/secrets/store.json
Oct-07 17:03:53.073 [main] DEBUG nextflow.secret.SecretsLoader - Discovered secrets providers: [nextflow.secret.LocalSecretsProvider@971e903] - activable => nextflow.secret.LocalSecretsProvider@971e903
Oct-07 17:03:53.092 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `server`
Oct-07 17:03:54.140 [main] DEBUG nextflow.config.ConfigBuilder - Available config profiles: [standard, server, cluster, laptop, aws]
Oct-07 17:03:54.200 [main] DEBUG nextflow.config.ConfigBuilder - Enabling execution in Docker container as requested by command-line option `-with-docker ubuntu:18.04`
Oct-07 17:03:54.214 [main] DEBUG nextflow.cli.CmdRun - Applied DSL=2 from script declaration
Oct-07 17:03:54.240 [main] DEBUG nextflow.cli.CmdRun - Launching `main.nf` [sleepy_yonath] DSL2 - revision: 8294306472
Oct-07 17:03:54.242 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins default=[]
Oct-07 17:03:54.243 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins resolved requirement=[nf-tower@1.9.1]
Oct-07 17:03:54.244 [main] DEBUG nextflow.plugin.PluginUpdater - Installing plugin nf-tower version: 1.9.1
Oct-07 17:03:54.253 [main] INFO  org.pf4j.AbstractPluginManager - Plugin 'nf-tower@1.9.1' resolved
Oct-07 17:03:54.253 [main] INFO  org.pf4j.AbstractPluginManager - Start plugin 'nf-tower@1.9.1'
Oct-07 17:03:54.270 [main] DEBUG nextflow.plugin.BasePlugin - Plugin started nf-tower@1.9.1
Oct-07 17:03:54.353 [main] DEBUG nextflow.Session - Session UUID: 1cf2e3c2-64a8-4876-8a9b-bdab0fb6acda
Oct-07 17:03:54.354 [main] DEBUG nextflow.Session - Run name: sleepy_yonath
Oct-07 17:03:54.354 [main] DEBUG nextflow.Session - Executor pool size: 160
Oct-07 17:03:54.365 [main] DEBUG nextflow.file.FilePorter - File porter settings maxRetries=3; maxTransfers=50; pollTimeout=null
Oct-07 17:03:54.373 [main] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'FileTransfer' minSize=10; maxSize=480; workQueue=LinkedBlockingQueue[10000]; allowCoreThreadTimeout=false
Oct-07 17:03:54.407 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 24.04.4 build 5917
  Created: 01-08-2024 07:05 UTC (00:05 PDT)
  System: Linux 5.15.0-89-generic
  Runtime: Groovy 4.0.21 on OpenJDK 64-Bit Server VM 11.0.9.1-internal+0-adhoc..src
  Encoding: UTF-8 (UTF-8)
  Process: 2068102@mustard [127.0.1.1]
  CPUs: 160 - Mem: 1.5 TB (1.2 TB) - Swap: 8 GB (8 GB)
Oct-07 17:03:54.476 [main] DEBUG nextflow.Session - Work-dir: /data/scratch/vpeddu/aPOMP/work [xfs]
Oct-07 17:03:54.528 [main] DEBUG nextflow.executor.ExecutorFactory - Extension executors providers=[]
Oct-07 17:03:54.545 [main] DEBUG nextflow.Session - Observer factory: DefaultObserverFactory
Oct-07 17:03:54.556 [main] DEBUG nextflow.Session - Observer factory: TowerFactory
Oct-07 17:03:54.595 [main] DEBUG nextflow.cache.CacheFactory - Using Nextflow cache factory: nextflow.cache.DefaultCacheFactory
Oct-07 17:03:54.610 [main] DEBUG nextflow.util.CustomThreadPool - Creating default thread pool > poolSize: 161; maxThreads: 1000
Oct-07 17:03:54.718 [main] DEBUG nextflow.Session - Session start
Oct-07 17:03:54.721 [main] DEBUG nextflow.trace.TraceFileObserver - Workflow started -- trace file: /data/scratch/vpeddu/aPOMP/trace-20241007-61434169.txt
Oct-07 17:03:56.150 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Oct-07 17:03:56.160 [main] WARN  nextflow.NextflowMeta$Preview - NEXTFLOW RECURSION IS A PREVIEW FEATURE - SYNTAX AND FUNCTIONALITY CAN CHANGE IN FUTURE RELEASES
Oct-07 17:03:58.302 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:Chopper` matches process Chopper
Oct-07 17:03:58.323 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.323 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.332 [main] DEBUG nextflow.executor.Executor - [warm up] executor > local
Oct-07 17:03:58.339 [main] DEBUG n.processor.LocalPollingMonitor - Creating local task monitor for executor 'local' > cpus=160; memory=1.5 TB; capacity=160; pollInterval=100ms; dumpInterval=5m
Oct-07 17:03:58.343 [main] DEBUG n.processor.TaskPollingMonitor - >>> barrier register (monitor: local)
Oct-07 17:03:58.429 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:NanoPlot` matches process NanoPlot
Oct-07 17:03:58.430 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.431 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.462 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:Host_depletion_nanopore` matches process Host_depletion_nanopore
Oct-07 17:03:58.465 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.466 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.495 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:Kraken_prefilter_nanopore` matches process Kraken_prefilter_nanopore
Oct-07 17:03:58.498 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.498 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.531 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.531 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.602 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:Minimap2_nanopore` matches process Minimap2_nanopore
Oct-07 17:03:58.604 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.605 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.638 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:Collect_alignment_results` matches process Collect_alignment_results
Oct-07 17:03:58.639 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.640 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.661 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.661 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.688 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.688 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.703 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-07 17:03:58.704 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-07 17:03:58.710 [main] DEBUG nextflow.Session - Workflow process names [dsl2]: Low_complexity_filtering_nanopore, Extract_db, Cluster_unclassified_reads, Classify, Collect_unassigned_results_illumina, Host_depletion_illumina, Minimap2_nanopore, Sam_conversion, Chopper_RT, Write_report_RT, Align_fungi, Collect_unassigned_results_RT, Trimming_FastP, Minimap2_illumina, Kraken_prefilter, Extract_true_novel, NanoPlot, Collect_unassigned_results, Write_report, Sourmash_prefilter_nanopore, Eggnog_mapper, Identify_resistant_plasmids, Collect_alignment_results, Kraken_prefilter_nanopore, Merge_classifiy_RT, Classify_RT, Accumulate_reports, MetaFlye, Extract_fungi, Low_complexity_filtering, Collect_alignment_results_RT, Host_depletion_nanopore, Classify_orthologs, Diamond_translated_alignment_unclassified, Combine_fq, Chopper, Write_report_orthologs
Oct-07 17:03:58.718 [main] DEBUG nextflow.Session - Igniting dataflow network (18)
Oct-07 17:03:58.735 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Chopper
Oct-07 17:03:58.735 [PathVisitor-5] DEBUG nextflow.file.PathVisitor - files for syntax: glob; folder: /private/groups/kimlab/vikas/metagenomics/publication/ncm_2024/input/time_tagged_input/CSF001/; pattern: **.fastq.gz; options: [:]
Oct-07 17:03:58.738 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > NanoPlot
Oct-07 17:03:58.741 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Host_depletion_nanopore
Oct-07 17:03:58.743 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Kraken_prefilter_nanopore
Oct-07 17:03:58.746 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Extract_db
Oct-07 17:03:58.748 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Minimap2_nanopore
Oct-07 17:03:58.749 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Collect_alignment_results
Oct-07 17:03:58.751 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Collect_unassigned_results
Oct-07 17:03:58.753 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Classify
Oct-07 17:03:58.755 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > Write_report
Oct-07 17:03:58.758 [main] DEBUG nextflow.script.ScriptRunner - Parsed script files:
  Script_981e6b93449c97e5: /data/scratch/vpeddu/aPOMP/./nanopore_modules.nf
  Script_de13b5ed5ed529fd: /data/scratch/vpeddu/aPOMP/main.nf
  Script_7db790caaa21c07d: /data/scratch/vpeddu/aPOMP/./illumina_modules.nf
Oct-07 17:03:58.758 [main] DEBUG nextflow.script.ScriptRunner - > Awaiting termination 
Oct-07 17:03:58.758 [main] DEBUG nextflow.Session - Session await
Oct-07 17:03:59.242 [Actor Thread 51] INFO  nextflow.processor.TaskProcessor - [df/17f062] Cached process > Chopper (1)
Oct-07 17:03:59.339 [Actor Thread 59] DEBUG nextflow.util.HashBuilder - Unable to get file attributes file: /media/vikas/fast/data/metagenomics_index/minimap2_host/hg38.fa -- Cause: java.nio.file.NoSuchFileException: /media/vikas/fast/data/metagenomics_index/minimap2_host/hg38.fa
Oct-07 17:03:59.340 [Actor Thread 59] DEBUG nextflow.util.HashBuilder - Unable to get file attributes file: /media/vikas/fast/data/metagenomics_index/ribosome_trna/all_trna.fa -- Cause: java.nio.file.NoSuchFileException: /media/vikas/fast/data/metagenomics_index/ribosome_trna/all_trna.fa
Oct-07 17:03:59.340 [Actor Thread 59] DEBUG nextflow.util.HashBuilder - Unable to get file attributes file: /media/vikas/fast/data/metagenomics_index/plasmid_db/plsdb.mmi -- Cause: java.nio.file.NoSuchFileException: /media/vikas/fast/data/metagenomics_index/plasmid_db/plsdb.mmi
Oct-07 17:03:59.357 [Actor Thread 59] INFO  nextflow.processor.TaskProcessor - [7e/65394b] Cached process > Host_depletion_nanopore (1)
Oct-07 17:03:59.375 [Actor Thread 74] DEBUG nextflow.util.HashBuilder - Unable to get file attributes file: /media/vikas/fast/data/metagenomics_index/kraken2_db -- Cause: java.nio.file.NoSuchFileException: /media/vikas/fast/data/metagenomics_index/kraken2_db
Oct-07 17:03:59.419 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Oct-07 17:03:59.422 [Task submitter] INFO  nextflow.Session - [c6/2d1e7a] Submitted process > NanoPlot (1)
Oct-07 17:03:59.441 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Oct-07 17:03:59.442 [Task submitter] INFO  nextflow.Session - [88/2172ec] Submitted process > Kraken_prefilter_nanopore (1)
Oct-07 17:04:00.786 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 4; name: Kraken_prefilter_nanopore (1); status: COMPLETED; exit: 0; error: -; workDir: /data/scratch/vpeddu/aPOMP/work/88/2172ec9ad95f81d1a4c151aca05f11]
Oct-07 17:04:00.787 [Task monitor] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'TaskFinalizer' minSize=10; maxSize=480; workQueue=LinkedBlockingQueue[10000]; allowCoreThreadTimeout=false
Oct-07 17:04:00.795 [TaskFinalizer-1] DEBUG nextflow.processor.TaskProcessor - Process `Kraken_prefilter_nanopore (1)` is unable to find [UnixPath]: `/data/scratch/vpeddu/aPOMP/work/88/2172ec9ad95f81d1a4c151aca05f11/04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.report` (pattern: `04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.report`)
Oct-07 17:04:00.800 [TaskFinalizer-1] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=Kraken_prefilter_nanopore (1); work-dir=/data/scratch/vpeddu/aPOMP/work/88/2172ec9ad95f81d1a4c151aca05f11
  error [nextflow.exception.MissingFileException]: Missing output file(s) `04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.report` expected by process `Kraken_prefilter_nanopore (1)`
Oct-07 17:04:00.870 [TaskFinalizer-1] ERROR nextflow.processor.TaskProcessor - Error executing process > 'Kraken_prefilter_nanopore (1)'

Caused by:
  Missing output file(s) `04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.report` expected by process `Kraken_prefilter_nanopore (1)`


Command executed:

  #!/bin/bash
  #logging
  echo "ls of directory" 
  ls -lah 
  
  # run kraken2
  kraken2 --db kraken2_db     --threads 16     --classified-out 04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.classified     --output 04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.output     --report 04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.report     --gzip-compressed     --unclassified-out 04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.unclassified     04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.host_filtered.fastq.gz 
  
  linecount=$(cat 04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.report | wc -l)

Command exit status:
  0

Command output:
  ls of directory
  total 28K
  drwxr-xrwx 2 30103  600 4.0K Oct  8 00:04 .
  drwxr-xr-x 3 30103  600   52 Oct  8 00:03 ..
  -rw-r--r-- 1 30103  600    0 Oct  8 00:03 .command.begin
  -rw-r--r-- 1 30103  600    0 Oct  8 00:03 .command.err
  -rw-r--r-- 1 30103  600   16 Oct  8 00:04 .command.log
  -rw-r--r-- 1 30103  600   16 Oct  8 00:04 .command.out
  -rw-r--r-- 1 30103  600  11K Oct  8 00:03 .command.run
  -rw-r--r-- 1 30103  600  665 Oct  8 00:03 .command.sh
  -rw-r--r-- 1 root  root    0 Oct  8 00:04 .command.trace
  lrwxrwxrwx 1 30103  600  142 Oct  8 00:03 04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.host_filtered.fastq.gz -> /data/scratch/vpeddu/aPOMP/work/7e/65394baf6ac9ba6cdd5ddc5426ae6c/04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.host_filtered.fastq.gz
  lrwxrwxrwx 1 30103  600   52 Oct  8 00:03 kraken2_db -> /media/vikas/fast/data/metagenomics_index/kraken2_db

Command error:
  kraken2: unable to find kraken2_db in $KRAKEN2_DB_PATH (undefined)
  cat: 04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.report: No such file or directory

Work dir:
  /data/scratch/vpeddu/aPOMP/work/88/2172ec9ad95f81d1a4c151aca05f11

Tip: view the complete command output by changing to the process work dir and entering the command `cat .command.out`
Oct-07 17:04:00.888 [TaskFinalizer-1] DEBUG nextflow.Session - Session aborted -- Cause: Missing output file(s) `04_25_23_R1041_ARUP_CSF001_rapid.dorado_0.7.3.hac.bam.kraken2.report` expected by process `Kraken_prefilter_nanopore (1)`
Oct-07 17:04:00.923 [main] DEBUG nextflow.Session - Session await > all processes finished
Oct-07 17:04:00.923 [Task monitor] DEBUG n.processor.TaskPollingMonitor - <<< barrier arrives (monitor: local) - terminating tasks monitor poll loop
Oct-07 17:04:00.930 [main] DEBUG nextflow.Session - Session await > all barriers passed
Oct-07 17:04:00.947 [main] WARN  n.processor.TaskPollingMonitor - Killing running tasks (1)
Oct-07 17:04:00.961 [main] DEBUG n.trace.WorkflowStatsObserver - Workflow completed > WorkflowStats[succeededCount=0; failedCount=1; ignoredCount=0; cachedCount=2; pendingCount=0; submittedCount=0; runningCount=0; retriesCount=0; abortedCount=1; succeedDuration=0ms; failedDuration=624ms; cachedDuration=13m 19s;loadCpus=0; loadMemory=0; peakRunning=2; peakCpus=17; peakMemory=130 GB; ]
Oct-07 17:04:00.961 [main] DEBUG nextflow.trace.TraceFileObserver - Workflow completed -- saving trace file
Oct-07 17:04:00.964 [main] DEBUG nextflow.trace.ReportObserver - Workflow completed -- rendering execution report
Oct-07 17:04:01.847 [main] DEBUG nextflow.cache.CacheDB - Closing CacheDB done
Oct-07 17:04:01.873 [main] INFO  org.pf4j.AbstractPluginManager - Stop plugin 'nf-tower@1.9.1'
Oct-07 17:04:01.873 [main] DEBUG nextflow.plugin.BasePlugin - Plugin stopped nf-tower
Oct-07 17:04:01.875 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
