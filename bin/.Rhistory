diffmod_table_04$sig = FALSE
diffmod_table_04$sig[diffmod_table_04$pval_KO_vs_WT < 0.05 ] = TRUE
# plot_krasko_04<-ggplot(diffmod_table_04, aes( x = diff_mod_rate_KO_vs_WT , y = neglogpval, color = sig)) +
#   geom_point() +
#   scale_y_log10() +
#   theme_classic() +
#   geom_hline(yintercept = -log10(0.05)) +
#   ylab('-log10(pval)') +
#   xlab('diffence in modification rate')
rownames(diffmod_table_04)<-diffmod_table_04$id
z<-head(diffmod_table_04)
diffmod_table_04$gene<-sapply(strsplit(as.character(diffmod_table_04$id), "\\|"), `[`, 5)
plot_krasko_04<-EnhancedVolcano(diffmod_table_04,
lab = diffmod_table_04$gene,
x = 'diff_mod_rate_KO_vs_WT',
y = 'pval_KO_vs_WT',
xlim = c(-1.5,1.5),
FCcutoff = 0.8,
pCutoff = 0.001,
title = 'KRASKO vs day 7',
subtitle = '')
plot_krasko_04
plot_krasko_04<-EnhancedVolcano(diffmod_table_04,
lab = diffmod_table_04$gene,
x = 'diff_mod_rate_KO_vs_WT',
y = 'pval_KO_vs_WT',
xlim = c(-1.5,1.5),
FCcutoff = 0.8,
pCutoff = 0.001,
pointSize = 1,
title = 'KRASKO vs day 7',
subtitle = '')
plot_krasko_04
plot_krasko_04<-EnhancedVolcano(diffmod_table_04,
lab = diffmod_table_04$gene,
x = 'diff_mod_rate_KO_vs_WT',
y = 'pval_KO_vs_WT',
xlim = c(-1.5,1.5),
ylim = c(0,1000),
FCcutoff = 0.8,
pCutoff = 0.001,
pointSize = 1,
title = 'KRASKO vs day 7',
subtitle = '')
plot_krasko_04
plot_krasko_04<-EnhancedVolcano(diffmod_table_04,
lab = diffmod_table_04$gene,
x = 'diff_mod_rate_KO_vs_WT',
y = 'pval_KO_vs_WT',
xlim = c(-1.5,1.5),
ylim = c(0,300),
FCcutoff = 0.8,
pCutoff = 0.001,
pointSize = 1,
title = 'KRASKO vs day 7',
subtitle = '')
plot_krasko_04
col
colnames(diffmod_table)
colnames(diffmod_table_04)
hist(diffmod_table_04$coverage_KO.rep1)
hist(diffmod_table_04$coverage_WT.rep1)
hist(diffmod_table_04$coverage_KO.rep1)
View(diffmod_table_12)
diffmod_table_12<-diffmod_table_12[diffmod_table_12$coverage_KO.rep1 > 99,]
diffmod_table_04<-diffmod_table_04[diffmod_table_04$coverage_KO.rep1 > 99,]
#rownames(diffmod_table_04)<-diffmod_table_04$id
z<-head(diffmod_table_04)
diffmod_table_04$gene<-sapply(strsplit(as.character(diffmod_table_04$id), "\\|"), `[`, 5)
plot_krasko_04<-EnhancedVolcano(diffmod_table_04,
lab = diffmod_table_04$gene,
x = 'diff_mod_rate_KO_vs_WT',
y = 'pval_KO_vs_WT',
xlim = c(-1.5,1.5),
ylim = c(0,300),
FCcutoff = 0.8,
pCutoff = 0.001,
pointSize = 1,
title = 'KRASKO vs day 7',
subtitle = '')
plot_krasko_04
diffmod_table_04<-diffmod_table_04[diffmod_table_04$coverage_KO.rep1 > 30 && diffmod_table_04$coverage_WT.rep1 > 30,]
#rownames(diffmod_table_04)<-diffmod_table_04$id
z<-head(diffmod_table_04)
diffmod_table_04$gene<-sapply(strsplit(as.character(diffmod_table_04$id), "\\|"), `[`, 5)
plot_krasko_04<-EnhancedVolcano(diffmod_table_04,
lab = diffmod_table_04$gene,
x = 'diff_mod_rate_KO_vs_WT',
y = 'pval_KO_vs_WT',
xlim = c(-1.5,1.5),
ylim = c(0,300),
FCcutoff = 0.8,
pCutoff = 0.001,
pointSize = 1,
title = 'KRASKO vs day 7',
subtitle = '')
plot_krasko_04
library(ggplot2)
setwd('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/')
reporting_stats = read.csv('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/zymo_reporting_stats.csv')
library(ggplot2)
setwd('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/')
reporting_stats = read.csv('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/zymo_reporting_stats.csv')
View(reporting_stats)
View(reporting_stats)
library(reshape)
library(reshape2)
reporting_stats_long = melt(reporting_stats)
View(reporting_stats_long)
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity")
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity"),
scale_color_viridis(discrete=TRUE)
library(viridis)
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity"),
scale_color_viridis(discrete=TRUE)
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity"),
scale_fill_viridis(discrete=TRUE)
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity"),
scale_fill_viridis()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE)
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
expand_limits(x = 0, y = 0) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
+ scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
plot
library(wesanderson)
install.packages("wesanderson")
library(wesanderson)
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
wes_palette("GrandBudapest1") +
#scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 1)) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
ymax(x =1) +
theme_classic()
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
ylim(x = 1) +
theme_classic()
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
ylim((0,1)) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
ylim((1)) +
theme_classic()
plot
?ylim
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
ylim((0,1)) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 0)) +
ylim(c(0,1)) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(0, 1)) +
#ylim(c(0,1)) +
theme_classic()
plot
?ylim
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(NA, 1)) +
theme_classic()
plot
?scale_y_continuous
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(NA, 1), limits = c(0,1)) +
theme_classic()
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(NA, 1), limits = c(0,1)) +
theme_classic() +
xlab('Pipepline') +
ylab('Percent')
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(NA, 1), limits = c(0,1)) +
theme_classic() +
xlab('Pipeline') +
ylab('Percent')
plot
plot = ggplot(reporting_stats_long, aes(fill=variable, y=value, x=name)) +
geom_bar(position="dodge", stat="identity") +
scale_fill_viridis(discrete=TRUE) +
scale_y_continuous(expand = c(NA, 1), limits = c(0,1)) +
theme_classic() +
xlab('Pipeline') +
ylab('Percent') +
theme(legend.title=element_blank())
plot
x = read.csv('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/raraefaction_stats.csv')
z = t(x)
View(z)
View(x)
x = read.csv('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/raraefaction_stats.csv')
z = t(x)
View(x)
x = read.csv('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/raraefaction_stats.csv')
z = t(x)
View(x)
x = read.csv('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/raraefaction_stats.csv')
z = t(x)
View(x)
View(z)
rarefaction_file = t(read.csv('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/raraefaction_stats.csv'))
View(rarefaction_file)
for (i in 1:nrow(rarefaction_file)){
name = rarefaction_file[i][1]
print(name)
}
for (i in 1:nrow(rarefaction_file)){
name = rarefaction_file[i][1][1]
print(name)
}
for (i in 1:nrow(rarefaction_file)){
name = rarefaction_file[i][1][1]
print(name)
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file[i])
print(name)
}
rownames(rarefaction_file)
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
print(name)
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file[i][1]
print(taxids)
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file[i][2]
print(taxids)
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
print(taxids)
}
rarefaction_file = as.data.frame(t(read.csv('/Users/vikas/Documents/UCSC/lab/kim_lab/evmeta/bin/raraefaction_stats.csv')))
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
print(taxids)
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V2[i]
print(taxids)
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
print(gsub("\\[|\\]", "", taxids))
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
print(noquote(gsub("\\[|\\]", "", taxids)))
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
print(strsplit(noquote(gsub("\\[|\\]", "", taxids)))",")
}
print(strsplit(noquote(gsub("\\[|\\]", "", taxids))),",")
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
print(strsplit(noquote(gsub("\\[|\\]", "", taxids))),",")
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
print(strsplit(noquote(gsub("\\[|\\]", "", taxids))),split = ",")
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
print(strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids))))
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))
print(split_counts)
}
rarefactions_long = data.frame(c('name','taxid','count'))
View(rarefactions_long)
rarefactions_long = data.frame(col.names = c('name','taxid','count'))
View(rarefactions_long)
rarefactions_long = as.data.frame(col.names = c('name','taxid','count'))
rarefactions_long = as.data.frame(c('name','taxid','count'))
View(rarefactions_long)
rarefactions_long = as.data.frame(colnames =('name','taxid','count'))
View(rarefactions_long)
rarefactions_long = as.data.frame(col.names =('name','taxid','count'))
rarefactions_long = as.data.frame(col.names =(c('name','taxid','count'))
rarefactions_long = as.data.frame(col.names =c('name','taxid','count'))
rarefactions_long = as.data.frame(col.names =c('name','taxid','count'))
data.frame(matrix(ncol=3,nrow=0, dimnames=list(NULL, c('name','taxid','count'))))
rarefactions_long <- data.frame(matrix(ncol=3,nrow=0, dimnames=list(NULL, c('name','taxid','count'))))
View(rarefactions_long)
rarefactions_long$name = rep(name, len(split_counts))
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))
rarefactions_long$name = rep(name, length(split_counts))
}
View(rarefactions_long)
rarefactions_long <- data.frame(matrix(ncol=3, dimnames=list(NULL, c('name','taxid','count'))))
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))
rarefactions_long$name = rep(name, length(split_counts))
}
View(rarefactions_long)
rep(name, length(split_counts)
)
rep(length(split_counts),name )
?rep
length(split_counts)
split_counts
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
rarefactions_long$name = rep(name, length(split_counts))
}
rep(name, length(split_counts))
rarefactions_long <- data.frame(matrix(ncol=3, dimnames=list(NULL, c('name','taxid','count'))))
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
rarefactions_long$name = rep(name, length(split_counts))
}
View(rarefactions_long)
rarefactions_long <- data.frame(matrix(ncol=3, dimnames=list(NULL, c('name','taxid','count'))))
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
rarefactions_long$name = rep(name, length(split_counts))
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
tmp = as.data.frame(rarefactions_long$name , split_taxids, split_counts)
#rbind(rep(name, length(split_counts)))
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
tmp = as.data.frame(rarefactions_long$name , split_taxids, split_counts)
#rbind(rep(name, length(split_counts)))
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
tmp = as.data.frame(rep(name, length(split_counts)) , split_taxids, split_counts)
#rbind(rep(name, length(split_counts)))
}
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
tmp = data.frame(rep(name,length(split_counts)) , split_taxids, split_counts)
#rbind(rep(name, length(split_counts)))
}
View(tmp)
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
tmp = data.frame(rep(name,length(split_counts)) , split_taxids, split_counts)
rbind(tmp, rarefactions_long)
}
colnames(tmp)<-c('name','taxid','count')
rbind(tmp, rarefactions_long)
rarefactions_long <- data.frame(matrix(ncol=3, dimnames=list(NULL, c('name','taxid','count'))))
for (i in 1:nrow(rarefaction_file)){
name = rownames(rarefaction_file)[i]
taxids = rarefaction_file$V1[i]
split_taxids = strsplit(split = ",",noquote(gsub("\\[|\\]", "", taxids)))[[1]]
counts = rarefaction_file$V2[i]
split_counts = strsplit(split = ",",noquote(gsub("\\[|\\]", "", counts)))[[1]]
tmp = data.frame(rep(name,length(split_counts)) , split_taxids, split_counts)
colnames(tmp)<-c('name','taxid','count')
rarefactions_long<-rbind(rarefactions_long,tmp)
}
View(rarefactions_long)
remotes::install_github("gauravsk/ranacapa")
BiocManager::install("phyloseq")
remotes::install_github("gavinsimpson/ggvegan")
library(ggvegan)
?ggvegan
?autoplot
install.packages(vegan)
BiocManager::install("vegan")
remotes::install_github("gauravsk/ranacapa")
